<div id="blocked-sites-container">
  <input type="text" class="blocked-site-input" placeholder="Enter site" onkeypress="handleKeyPress(event)" oninput="validateInputEvent(event)" id="firstBox"></input>
</div>

<style>
    .blocked-site-input {
        display: block;
        margin-bottom: 5px;
    }
    .blocked-site-wrapper {
        position: relative;
        display: inline-block;
    }
    .remove-btn {
        display: none;
        position: absolute;
        right: 0;
        top: 0;
        cursor: pointer;
        background-color: transparent;
        color: red;
        border: none;
        padding: 2px 5px;
        transform: rotate(45deg);
    }
    .blocked-site-wrapper:hover .remove-btn {
        display: inline;
    }
</style>

<script>
    function handleKeyPress(event) {
        if (event.key === 'Enter') {
            const input = event.target;
            if (input.value.trim() !== '') {
                createNewInput(input.value);
                input.value = '';
            }
        }
    }

    function createNewInput(value) {
        const container = document.getElementById('blocked-sites-container');
        const wrapper = document.createElement('div');
        wrapper.className = 'blocked-site-wrapper';

        const newInput = document.createElement('input');
        newInput.type = 'text';
        newInput.className = 'blocked-site-input';
        newInput.value = value;
        newInput.onkeypress = handleKeyPress;
        newInput.oninput = validateInput;

        const removeBtn = document.createElement('button');
        removeBtn.className = 'remove-btn';
        removeBtn.innerText = '+';
        removeBtn.onclick = () => container.removeChild(wrapper);

        wrapper.appendChild(newInput);
        wrapper.appendChild(removeBtn);
        container.appendChild(wrapper);
    }

    function validateInput(input){
      //console.log(input);
      const validPattern = /^[a-z0-9.]*$/;
      input = input.toLowerCase(); // Convert to lowercase
      if (!validPattern.test(input)) {
          return input.replace(/[^a-z0-9.]/g, '');
      }
      return input;
    }

    function validateInputEvent(event) {
            let input = event.target;
            // Replace newline characters with new entries
            if (input.value.includes(' ')) {
                const values = input.value.split(' ');
                input.value = validateInput(values[0]);
                for (let i = 1; i < values.length; i++) {
                    if (values[i].trim() !== '') {
                        createNewInput(validateInput(values[i]));
                    }
                }
            }
            else{
              input.value = validateInput(input.value)
            }
        }


    document.addEventListener('input', () => {
        const inputs = document.querySelectorAll('.blocked-site-input');
        inputs.forEach(input => {
            if (input.value.trim() === '' && input.id != "firstBox") {
                input.parentElement.remove();
            }
        });
    });

    function createInputs(values){
      let input = document.getElementById("firstBox");
      input.value = validateInput(values[0]);
      for (let i = 1; i < values.length; i++) {
          if (values[i].trim() !== '') {
              createNewInput(validateInput(values[i]));
          }
      }
    }

    function clearInputs(){
      const inputs = document.querySelectorAll('.blocked-site-input');
      inputs.forEach(input => {
          if (input.id != "firstBox") {
              input.parentElement.remove();
          }
          else{
              input.value = "";
          }
      });
    }
</script>
